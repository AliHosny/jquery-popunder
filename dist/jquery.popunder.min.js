/* jquery-plugin to create popunders in major browsers., v0.1 https://github.com/hpbuniat/jquery-popunder
Copyright (c) 2013 Hans-Peter Buniat, BSD license https://github.com/hpbuniat/jquery-popunder/blob/master/LICENSE */
(function(a,b,c){"use strict",a.popunder=function(c,d,e,f){var g=a.popunder.helper;return arguments.length===0&&(c=b.aPopunder),e||d?g.bindEvents(c,d,e):(c=typeof c=="function"?c(f):c,typeof c!="undefined"&&(g.c=0,g.queue(c).queue(c))),a},a.popunder.helper={_top:b.self,lastWin:null,lastTarget:null,c:0,last:!1,b:"about:blank",o:null,g:a.browser.webkit,queue:function(a){var b=!1,c=this;if(a.length)while(b===!1){var d=a.shift();b=d?c.open(d[0],d[1]||{},a.length):!0}else c.last===!1&&(!c.g||c.c===0)&&(c.last=!0,c.bg().href(!0));return this},bindEvents:function(b,c,d){var e=function(c){return a.popunder(b,!1,!1,c),!0};c&&(c=typeof c=="string"?a(c):c,c.on("submit",e)),d&&(d=typeof d=="string"?a(d):d,d.on(this.g===!0?"click mousedown":"click",e))},cookieCheck:function(b,c){var d=this.rand(c.cookie,!1),e=a.cookie(d),f=!1;return e?e.indexOf(b)===-1?e+=b:f=!0:e=b,a.cookie(d,e,{expires:new Date((new Date).getTime()+c.blocktime*36e5)}),f},rand:function(a,b){var c=a?a:"pu";return c+(b===!1?"":Math.floor(89999999*Math.random()+1e7))},open:function(c,d,e){var f=this;f.o=f.g?f.b:c;if(top!==b.self)try{top.document.location.toString()&&(f._top=top)}catch(g){}return d.disableOpera=d.disableOpera||!0,d.disableOpera===!0&&a.browser.opera===!0?!1:(d.blocktime=d.blocktime||!1,d.cookie=d.cookie||"puCookie",d.blocktime&&typeof a.cookie=="object"&&f.cookieCheck(c,d)?!1:(f.c++,f.lastTarget=c,f.lastWin=f._top.window.open(f.o,f.rand(d.name,!d.name),f.getOptions(d))||f.lastWin,f.g||f.bg(),f.href(e),!0))},bg:function(c){var d=this;if(d.lastWin){d.lastWin.blur(),d._top.window.blur(),d._top.window.focus();if(this.lastTarget&&!c)if(a.browser.msie===!0){b.focus();try{opener.window.focus()}catch(e){}}else(function(a){d.flip(a);try{a.opener.window.focus()}catch(b){}})(d.lastWin)}return this},href:function(a){var b=this;return a&&b.lastTarget&&b.lastWin&&b.lastTarget!==b.b&&b.lastTarget!==b.o&&(b.lastWin.document.location.href=b.lastTarget),b},flip:function(a){try{(typeof a.window.mozPaintCount!="undefined"||typeof a.navigator.webkitGetUserMedia=="function")&&a.window.open("about:blank").close()}catch(b){}},getOptions:function(a){return"toolbar="+(a.toolbar||"0")+",scrollbars="+(a.scrollbars||"1")+",location="+(a.location||"1")+",statusbar="+(a.statusbar||"1")+",menubar="+(a.menubar||"0")+",resizable="+(a.resizable||"1")+",width="+(a.width||(c.availWidth-122).toString())+",height="+(a.height||(c.availHeight-122).toString())+",screenX="+(a.screenX||"0")+",screenY="+(a.screenY||"0")+",left="+(a.left||"0")+",top="+(a.top||"0")}}})(jQuery,window,screen);