/* jquery-plugin to create popunders in major browsers., v0.1 https://github.com/hpbuniat/jquery-popunder
Copyright (c) 2013 Hans-Peter Buniat, BSD license https://github.com/hpbuniat/jquery-popunder/blob/master/LICENSE */
(function(e,t,n){"use strict";if(typeof i=="undefined"){var r=n.userAgent.toLowerCase(),i=function(e){return new i.fn.init(e)};i.fn=i.prototype={constructor:i,init:function(e){var n=t.querySelectorAll;return e.nodeType?this.elem=[e]:typeof e=="function"?e():typeof e=="string"&&(this.elem=n?t.querySelectorAll(e):t.getElementById(e.substr(1)),n||(this.elem=[this.elem])),this},elem:null},i.extend=i.fn.extend=function(){var e,t,n,r,i=this,s=0,o=arguments.length;for(;s<o;s++)if((e=arguments[s])!=null)for(t in e)if(e.hasOwnProperty(t)){n=i[t],r=e[t];if(i===r)continue;r!==undefined&&(i[t]=r)}return i},i.fn.extend({on:function(e,n){var r,i,s,o,u,a;if(!this.elem)return this;e=e.split(" ");for(r=0,s=e.length;r<s;r++){u=e[r];for(i=0,o=this.elem.length;i<o;i++)a=this.elem[i],t.attachEvent?a.attachEvent("on"+u,n):t.addEventListener&&a.addEventListener(u,n,!1)}return this},attr:function(e,t){if(this.elem&&this.elem.length){if(!t)return this.elem[0].getAttribute(e);this.elem[0].setAttribute(e,t)}return this},each:function(e){var t,n;for(t=0,n=this.elem.length;t<n;t++)e(t,this.elem[t]);return this},data:function(e){return this.attr("data-"+e)}}),i.browser={webkit:/webkit/.exec(r)||!1,opera:/opera/.exec(r)||!1,msie:/msie/.exec(r)||!1},i.fn.init.prototype=i.fn,e.jQuery=e.$=i}})(window,document,navigator),function(e,t,n){"use strict";e.popunder=function(t,n,r,i){var s=e.popunder.helper;return r||n?s.bindEvents(t,n,r):(t=typeof t=="function"?t(i):t,s.c=0,s.queue(t).queue(t)),e},e.popunder.helper={_top:t.self,lastWin:null,lastTarget:null,c:0,last:!1,b:"about:blank",o:null,g:e.browser.webkit,queue:function(e){var t=!1,n=this;if(e.length)while(t===!1){var r=e.shift();t=n.open(r[0],r[1]||{},e.length)}else n.last===!1&&(!n.g||n.c===0)&&(n.last=!0,n.bg().href(!0));return this},bindEvents:function(t,n,r){var i=function(n){return e.popunder(t,!1,!1,n),!0};n&&(n=typeof n=="string"?e(n):n,n.on("submit",i)),r&&(r=typeof r=="string"?e(r):r,r.on(this.g===!0?"click mousedown":"click",i))},cookieCheck:function(t,n){var r=this.rand(n.cookie,!1),i=e.cookie(r),s=!1;return i?i.indexOf(t)===-1?i+=t:s=!0:i=t,e.cookie(r,i,{expires:new Date((new Date).getTime()+n.blocktime*36e5)}),s},rand:function(e,t){var n=e?e:"pu";return n+(t===!1?"":Math.floor(89999999*Math.random()+1e7))},open:function(n,r,i){var s=this;s.o=s.g?s.b:n;if(top!==t.self)try{top.document.location.toString()&&(s._top=top)}catch(o){}return r.disableOpera=r.disableOpera||!0,r.disableOpera===!0&&e.browser.opera===!0?!1:(r.blocktime=r.blocktime||!1,r.cookie=r.cookie||"puCookie",r.blocktime&&typeof e.cookie=="object"&&s.cookieCheck(n,r)?!1:(s.c++,s.lastTarget=n,s.lastWin=s._top.window.open(s.o,s.rand(r.name,!r.name),s.getOptions(r))||s.lastWin,s.g||s.bg(),s.href(i),!0))},bg:function(n){var r=this;if(r.lastWin){r.lastWin.blur(),r._top.window.blur(),r._top.window.focus();if(this.lastTarget&&!n)if(e.browser.msie===!0){t.focus();try{opener.window.focus()}catch(i){}}else(function(e){r.flip(e);try{e.opener.window.focus()}catch(t){}})(r.lastWin)}return this},href:function(e){var t=this;return e&&t.lastTarget&&t.lastWin&&t.lastTarget!==t.b&&t.lastTarget!==t.o&&(t.lastWin.document.location.href=t.lastTarget),t},flip:function(e){try{(typeof e.window.mozPaintCount!="undefined"||typeof e.navigator.webkitGetUserMedia=="function")&&e.window.open("about:blank").close()}catch(t){}},getOptions:function(e){return"toolbar="+(e.toolbar||"0")+",scrollbars="+(e.scrollbars||"1")+",location="+(e.location||"1")+",statusbar="+(e.statusbar||"1")+",menubar="+(e.menubar||"0")+",resizable="+(e.resizable||"1")+",width="+(e.width||(n.availWidth-122).toString())+",height="+(e.height||(n.availHeight-122).toString())+",screenX="+(e.screenX||"0")+",screenY="+(e.screenY||"0")+",left="+(e.left||"0")+",top="+(e.top||"0")}}}(jQuery,window,screen);